<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>EBS Insight</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&family=JetBrains+Mono:wght@500&display=swap');
        body { font-family: 'Plus Jakarta Sans', sans-serif; background: radial-gradient(circle at top right, #1e1b4b, #0f172a); }
        .glass { background: rgba(30, 41, 59, 0.7); backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.05); }
        .glow-blue { box-shadow: 0 0 20px rgba(59, 130, 246, 0.15); }
        .mono { font-family: 'JetBrains Mono', monospace; }
        .progress-glow { box-shadow: 0 0 10px rgba(59, 130, 246, 0.5); }
    </style>
</head>
<body class="text-slate-200 min-h-screen pb-20">
    <nav class="p-6 px-10 flex justify-between items-center border-b border-white/5 glass sticky top-0 z-50">
        <div class="flex items-center gap-4">
            <div class="h-10 w-10 bg-gradient-to-tr from-blue-600 to-violet-600 rounded-xl flex items-center justify-center shadow-lg rotate-3">
                <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>
            </div>
            <div>
                <h1 class="text-xl font-extrabold tracking-tighter bg-clip-text text-transparent bg-gradient-to-r from-white to-slate-400">EBS TREASURE CORE</h1>
                <div class="text-[10px] text-blue-400 font-bold tracking-[0.2em] uppercase leading-none">Intelligence Dashboard</div>
            </div>
        </div>
        <div id="clock" class="mono text-xs text-slate-500 bg-black/20 px-4 py-2 rounded-full border border-white/5"></div>
    </nav>

    <main class="max-w-7xl mx-auto mt-10 px-6">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-10">
            <div class="glass p-6 rounded-3xl glow-blue">
                <div class="text-slate-500 text-[10px] font-bold uppercase tracking-widest mb-2">Total Managed Volumes</div>
                <div id="stat-count" class="text-4xl font-black text-white">0</div>
            </div>
            <div class="glass p-6 rounded-3xl col-span-2 relative overflow-hidden">
                <div class="relative z-10">
                    <div class="text-slate-500 text-[10px] font-bold uppercase tracking-widest mb-3">Instant Search</div>
                    <input type="text" id="filter" placeholder="Filter by Node, PVC, or ID..." 
                           class="w-full bg-white/5 border border-white/10 p-3 rounded-2xl focus:ring-2 focus:ring-blue-500 outline-none transition-all text-sm placeholder:text-slate-600">
                </div>
            </div>
        </div>

        <div class="glass rounded-[2rem] overflow-hidden shadow-2xl border border-white/10">
            <table class="w-full text-left">
                <thead class="bg-white/[0.02] border-b border-white/5 text-slate-500 text-[10px] uppercase font-black tracking-widest">
                    <tr>
                        <th class="p-6">Identity & Namespace</th>
                        <th class="p-6">Hardware Status</th>
                        <th class="p-6">Performance Profile</th>
                        <th class="p-6 text-right">Resource Saturation</th>
                    </tr>
                </thead>
                <tbody id="main-grid" class="divide-y divide-white/5">
                    </tbody>
            </table>
        </div>
    </main>

    <script>
        async function refresh() {
            const res = await fetch('/api/data');
            const data = await res.json();
            document.getElementById('stat-count').innerText = data.length;
            
            const grid = document.getElementById('main-grid');
            grid.innerHTML = data.map(item => `
                <tr class="group hover:bg-white/[0.03] transition-all duration-300">
                    <td class="p-6">
                        <span class="text-[9px] font-black text-blue-500 bg-blue-500/10 px-2 py-0.5 rounded-md mb-2 inline-block uppercase tracking-tighter">${item.namespace}</span>
                        <div class="text-md font-extrabold text-white group-hover:translate-x-1 transition-transform duration-300">${item.name}</div>
                    </td>
                    <td class="p-6">
                        <div class="flex items-center gap-3 mb-2">
                            <span class="mono text-xs font-bold text-blue-300">${item.volume_id}</span>
                            <span class="text-[9px] font-black px-2 py-1 rounded-lg border ${item.encrypted ? 'bg-emerald-500/10 text-emerald-400 border-emerald-500/20' : 'bg-rose-500/10 text-rose-400 border-rose-500/20'}">
                                ${item.encrypted ? 'SECURED' : 'UNENCRYPTED'}
                            </span>
                        </div>
                        <div class="text-[10px] text-slate-500 font-medium tracking-tight">
                            <span class="text-slate-400 uppercase">Region:</span> ${item.region} â€¢ <span class="text-slate-400">${item.node}</span>
                        </div>
                    </td>
                    <td class="p-6">
                        <div class="flex gap-2">
                            <div class="bg-black/40 border border-white/10 rounded-xl p-2 min-w-[70px] text-center">
                                <div class="text-[8px] text-slate-600 font-black uppercase">IOPS</div>
                                <div class="mono text-xs text-blue-400 font-bold">${item.iops}</div>
                            </div>
                            <div class="bg-black/40 border border-white/10 rounded-xl p-2 min-w-[70px] text-center">
                                <div class="text-[8px] text-slate-600 font-black uppercase">TPUT</div>
                                <div class="mono text-xs text-blue-400 font-bold">${item.throughput}</div>
                            </div>
                        </div>
                    </td>
                    <td class="p-6 text-right">
                        <div class="flex items-center justify-end gap-4 mb-2">
                            <span class="text-sm font-black ${item.percent > 85 ? 'text-rose-500' : 'text-blue-400'}">${Math.round(item.percent)}%</span>
                            <div class="w-32 bg-slate-800/50 h-2.5 rounded-full overflow-hidden border border-white/5">
                                <div class="h-full progress-glow transition-all duration-1000 ${item.percent > 85 ? 'bg-rose-500' : 'bg-gradient-to-r from-blue-600 to-violet-500'}" style="width: ${item.percent}%"></div>
                            </div>
                        </div>
                        <div class="mono text-[10px] text-slate-500 font-bold">${item.used_gb.toFixed(2)} GB / ${item.total_gb.toFixed(1)} GB</div>
                    </td>
                </tr>
            `).join('');
            document.getElementById('clock').innerText = 'LAST REFRESH: ' + new Date().toLocaleTimeString();
        }

        document.getElementById('filter').addEventListener('input', (e) => {
            const val = e.target.value.toLowerCase();
            document.querySelectorAll('#main-grid tr').forEach(row => {
                row.style.display = row.innerText.toLowerCase().includes(val) ? '' : 'none';
            });
        });

        setInterval(refresh, 10000);
        refresh();
    </script>
</body>
</html>
